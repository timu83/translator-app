<!doctype html>
<html lang="tr" data-theme="dark">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>TR ↔ EN Çeviri</title>
<style>
:root{ --radius:14px; --brand:#1b5cff; --brand2:#2d6bff; }
:root[data-theme="dark"]{
  --ink:#e6eef8;--muted:#9bb3c7;--line:#1e2a36;
  --bg1:#09121a;--bg2:#0b0f14;--card:#121a22;--field:#0f1620;
  --shadow:0 12px 40px rgba(0,0,0,.28);--focus-ring:rgba(42,139,255,.18)
}
:root[data-theme="light"]{
  --ink:#0b1220;--muted:#536176;--line:#dbe5f1;
  --bg1:#f6f9fe;--bg2:#eef5ff;--card:#fff;--field:#fff;
  --shadow:0 10px 28px rgba(13,37,62,.12);--focus-ring:rgba(53,131,255,.18)
}
*,*::before,*::after{box-sizing:border-box}
body{margin:0;background:linear-gradient(180deg,var(--bg1),var(--bg2));color:var(--ink);
  font:14px/1.5 system-ui,-apple-system,Segoe UI,Roboto,sans-serif;transition:background .25s,color .25s}
.wrap{max-width:980px;margin:40px auto;padding:0 20px}
.card{background:var(--card);border:1px solid var(--line);border-radius:18px;padding:20px;box-shadow:var(--shadow);transition:background .25s,border-color .25s}
h1{margin:0 0 12px;font-size:22px}
.toolbar{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-bottom:12px}
.toolbar-left{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.toolbar-right{margin-left:auto;display:flex;align-items:center;gap:6px}
select,button{height:40px;border-radius:12px;border:1px solid var(--line);background:var(--field);color:var(--ink);padding:0 12px;cursor:pointer;transition:background .2s,border-color .2s,color .2s}
button.primary{background:var(--brand);border-color:var(--brand2);font-weight:600;color:#fff}
button:disabled{opacity:.6;cursor:not-allowed}
.iconbtn{display:inline-flex;align-items:center;justify-content:center;width:40px;min-width:40px;padding:0}
.iconbtn svg{width:18px;height:18px}
.grid{display:grid;grid-template-columns:1fr;gap:12px}
@media(min-width:860px){.grid{grid-template-columns:1fr 1fr}}
textarea{width:100%;height:260px;padding:14px;border-radius:var(--radius);
  border:1px solid var(--line);background:var(--field);color:var(--ink);
  resize:none;outline:none;transition:background .2s,border-color .2s,color .2s}
textarea:focus{border-color:#2a8bff;box-shadow:0 0 0 3px var(--focus-ring)}
.muted{color:var(--muted);font-size:12px}
.status{padding:4px 8px;border-radius:999px;border:1px solid var(--line);font-size:12px;color:var(--muted)}
.status.ok{color:#1a7f39;background:rgba(26,127,57,.08);border-color:rgba(26,127,57,.25)}
.progress{height:3px;background:rgba(12,18,32,.35);border-radius:999px;overflow:hidden;margin-top:10px;display:none}
.progress>div{height:100%;background:linear-gradient(90deg,var(--brand),var(--brand2));animation:indet 1.2s infinite}
@keyframes indet{0%{transform:translateX(-30%);width:30%}50%{transform:translateX(30%);width:60%}100%{transform:translateX(140%);width:30%}}
.footer{display:flex;gap:10px;justify-content:flex-end;margin-top:12px;flex-wrap:wrap}
.theme-label{font-size:13px;color:var(--muted);user-select:none}
.badge{font-size:12px;padding:4px 8px;border:1px solid var(--line);border-radius:999px;color:var(--muted)}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>TR ↔ EN Çeviri</h1>

    <div class="toolbar">
      <div class="toolbar-left">
        <label for="direction" class="muted">Yön</label>
        <select id="direction">
          <option value="tr2en">Türkçe → İngilizce</option>
          <option value="en2tr">İngilizce → Türkçe</option>
        </select>

        <label for="model" class="muted">Model</label>
        <select id="model" title="Çeviri motoru">
          <option value="gpt-4.1-mini">ChatGPT mini (gpt-4.1-mini)</option>
          <option value="o4-mini">Mini o4 (o4-mini)</option>
        </select>

        <button id="swap">Değiştir</button>
        <button id="translate" class="primary">Çevir</button>
        <span class="muted">Ctrl/Cmd + Enter</span>
        <span id="status" class="status">Hazır</span>
      </div>

      <div class="toolbar-right">
        <span id="themeLabel" class="theme-label">Dark / Light</span>
        <button id="themeToggle" class="iconbtn" title="Gece/Gündüz">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
               stroke-linecap="round" stroke-linejoin="round">
            <path d="M9 18h6"/>
            <path d="M10 22h4"/>
            <path d="M12 2a7 7 0 0 0-4 12c.6.6 1 1.5 1 2.5h6c0-1 .4-1.9 1-2.5A7 7 0 0 0 12 2z"/>
          </svg>
        </button>
      </div>
    </div>

    <div class="grid">
      <textarea id="input" placeholder="Çevrilecek metni yaz veya yapıştır"></textarea>
      <textarea id="output" placeholder="Çeviri burada görünecek" readonly></textarea>
    </div>

    <div id="progress" class="progress"><div></div></div>

    <div class="footer">
      <span id="activeModel" class="badge">Model: gpt-4.1-mini</span>
      <button id="copy">Kopyala</button>
      <button id="clear">Temizle</button>
    </div>
  </div>
</div>

<script>
const $ = s => document.querySelector(s);
const input = $('#input'), output = $('#output'), dir = $('#direction'), modelSel = $('#model');
const statusEl = $('#status'), progress = $('#progress'), btn = $('#translate');
const themeLabel = $('#themeLabel'), activeModel = $('#activeModel');

/* Tema toggle */
const THEME_KEY='translator-theme';
function setTheme(mode){
  document.documentElement.setAttribute('data-theme', mode);
  localStorage.setItem(THEME_KEY, mode);
  themeLabel.textContent = 'Dark / Light';
}
(()=>{ const saved=localStorage.getItem(THEME_KEY); setTheme(saved==='light'?'light':'dark'); })();
$('#themeToggle').addEventListener('click',()=>{
  const cur=document.documentElement.getAttribute('data-theme');
  setTheme(cur==='dark'?'light':'dark');
});

/* Model seçimi kalıcı olsun */
const MODEL_KEY='translator-model';
(function initModel(){
  const saved = localStorage.getItem(MODEL_KEY);
  if (saved && [...modelSel.options].some(o=>o.value===saved)) {
    modelSel.value = saved;
  }
  activeModel.textContent = 'Model: ' + modelSel.value;
})();
modelSel.addEventListener('change', ()=>{
  localStorage.setItem(MODEL_KEY, modelSel.value);
  activeModel.textContent = 'Model: ' + modelSel.value;
});

/* Çeviri */
function setBusy(b,msg){
  btn.disabled = b;
  statusEl.textContent = msg || (b ? 'Çevriliyor' : 'Hazır');
  statusEl.className = 'status' + (b ? '' : ' ok');
  progress.style.display = b ? 'block' : 'none';
}
async function translate(){
  const text = input.value.trim(); if(!text) return;
  setBusy(true,'Çevriliyor');
  try{
    const r = await fetch('/api/translate',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({ text, direction: dir.value, model: modelSel.value })
    });
    const txt=await r.text(); let data={}; try{ data=JSON.parse(txt);}catch{}
    if(!r.ok) throw new Error(data.error||txt||'Sunucu hatası');
    output.value = data.translation || ''; setBusy(false,'Bitti');
  }catch(e){ console.error(e); setBusy(false,'Hata'); }
}
$('#translate').addEventListener('click',translate);
$('#swap').addEventListener('click',()=>{
  dir.value = dir.value==='tr2en' ? 'en2tr' : 'tr2en';
  const t = input.value; input.value = output.value; output.value = t; input.focus();
});
$('#copy').addEventListener('click',async()=>{
  if(!output.value) return;
  try{ await navigator.clipboard.writeText(output.value); statusEl.textContent='Kopyalandı'; }catch{}
});
$('#clear').addEventListener('click',()=>{
  input.value=''; output.value=''; statusEl.textContent='Hazır'; input.focus();
});
document.addEventListener('keydown',e=>{ if((e.ctrlKey||e.metaKey)&&e.key==='Enter') translate(); });
</script>
</body>
</html>
